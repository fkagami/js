<!DOCTYPE html>
<html>
<head>
<title>Title of the document</title>
<meta http-equiv="Content-Type" content="text/htmll; charset=UTF-8" />
</head>
<body>
<form name="fm">
<label>name:
  <input type="text" name="name" size="15" />
</label>
  <input type="button" name="submit" value="send" onclick="asyncSend()" />
</form>
<div id="result"></div>
<?php
sleep(3);
print('こんにちは '.$_REQUEST['name'].'さん！');
?>
<script type="text/javascript">
<!--
function getXHR() {
  var req;
  try {
    req = new XMLHttpRequest();
  } catch(e) {
    try {
      req = new ActiveXObject('Msxml2.XMLHTTP');
    } catch(e) {
      req = new ActiveXObject('Microsoft.XMLHTTP');
    }
  }
  return req;
}

function asyncSend() {
  var req = getXHR();
  //非同期通信時の処理、コールバック関数を定義
  req.onreadystatechange = function() {
    var result = document.getElementById('result');
    if (req.readyState == 4){//通信完了時
      if (req.status == 200) {//通信が成功した時
        result.innnerHTML = req.responseText;
      } else {//通信が失敗した時
        result.innnerHTML = "Server Error"
      }
    } else {//通信が完了する前
      result.innnerHTML = "Now loading";
    }
  }
  //サーバーとの非同期通信を開始
  req.open('GET', 'helloAjax.php?name=' + encodeURIComponent(document.fm.name.value), true);
  req.send(null);
}
//-->
</script>
</body>
</html>

